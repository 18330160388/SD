"""
训练配置参数
"""

# ==================== 模型配置 ====================
MODEL_PATH = "D:\\liubotao\\other\\BIT_TS\\LLM_GCG\\code\\models\\Qwen2___5-0___5B-Instruct"
DEVICE = "cuda"  # 或 "cpu"
MIDDLE_LAYER_IDX = 12  # 提取第12层的隐藏状态

# ==================== 形态特征维度 ====================
MORPH_DIM = 254  # 244部首 + 6笔画 + 4结构
HIDDEN_DIM = 896  # Qwen2.5-0.5B的隐藏层维度

# ==================== 训练参数 ====================
LEARNING_RATE = 1e-3
BATCH_SIZE = 64
NUM_EPOCHS = 3000  # 继续训练，损失仍在稳定下降
WEIGHT_DECAY = 1e-5
EARLY_STOP_PATIENCE = 100  # 增加patience，避免过早停止

# ==================== 数据配置 ====================
sentences = [
    "江河湖海都是水",
    "江边有很多人钓鱼。",
    "河水涨了，桥快被淹没。",
    "湖里有几只鸭子。",
    "海风很大，浪也高。",
    "池中种了荷花。",
    "泉水可以直接饮用。",
    "雨下了一整天。",
    "浪拍打着岸边。",
    "波纹在水面扩散。",
    "溪水很清澈。",
    "沙地上很难走路。",
    "山上有很多松树。",
    "石头很重，搬不动。",
    "岛上没有人居住。",
    "岩壁上有很多裂缝。",
    "洞里很黑，需要手电筒。",
    "泥巴弄脏了鞋子。",
    "林间有很多鸟叫声。",
    "草地上有露水。",
    "花开得很鲜艳。",
    "树下可以乘凉。",
    "竹子长得很快。",
    "松针掉了一地。",
    "梅树已经结果了。",
    "荷叶上有水珠。",
    "牛在田里吃草。",
    "羊喜欢在山坡上活动。",
    "鱼在水里游来游去。",
    "鸟在树枝上唱歌。",
    "马在草原上奔跑。",
    "虎在林中休息。",
    "狗在院子里晒太阳。",
    "猫在窗台上打盹。",
    "云很低，快要下雨了。",
    "风把树叶吹落了。",
    "雪覆盖了整个院子。",
    "雷声很响，小孩有点害怕。",
    "雾让路变得模糊。",
    "金项链很贵。",
    "木桌子很结实。",
    "铁门很重。",
    "铜壶可以煮水。",
    "银勺子很亮。",
    "火把木头烧成灰。",
    "电灯突然灭了。",
]

# ==================== 输出路径 ====================
import os
from pathlib import Path

TRAIN_DIR = Path(__file__).parent
DATA_FILE = TRAIN_DIR / "training_data.pkl"
MODEL_SAVE_PATH = TRAIN_DIR / "morph_embedding_best.pt"
CURVE_SAVE_PATH = TRAIN_DIR / "training_curve.png"
LOG_FILE = TRAIN_DIR / "training.log"
