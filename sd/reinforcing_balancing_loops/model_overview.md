# 系统动力学语义演化预测模型

## 🎯 模型概述

基于经典系统动力学理论的增强-调节回路模型，用于预测Transformer中token语义聚合的演化过程。

## 🔄 核心回路结构

### 1. 增强回路 (R1)
- **机制**：前层聚合驱动后层聚合，形成正反馈
- **数学表达**：曲率演化速率 →[+] 曲率 →[+] 下一层聚合速率
- **参数**：R1_gain = 0.6

### 2. 调节回路 (B1) - 语义稳定性
- **机制**：聚合过度时通过语义稳定性抑制
- **语义稳定性计算**：`semantic_stability = 1 / (1 + S²)`
- **其中S**：语义漂移系数（反映token语义向量的时空稳定性）
- **参数**：B1_gain = 0.3, B1_delay = 1

### 3. 调节回路 (B2) - 距离变化
- **机制**：聚合过度时通过距离变化增加阻力
- **数学表达**：曲率 →[+] 距离变化 →[+] 聚合阻力 →[-] 聚合速率
- **参数**：B2_gain = 0.2, B2_threshold = 0.001

## 📊 核心公式

### 语义聚合速率定义
**语义聚合速率**（曲率演化速率）：直接使用Transformer各层观测到的实际曲率变化率
- **数据来源**：`token_data['曲率演化率 dK/dt(L)']`
- **物理意义**：反映token语义聚合的瞬时变化速度
- **单位**：每层曲率变化量

### 基础演化方程
```
曲率演化速率(L) = R1_gain × 曲率演化速率(L-1) × (1 - B1_effect - B2_effect)
```

### 调节因子计算
```
regulation_factor = 1.0 + r1_effect × 0.01 - b1_effect × 0.01 - b2_effect × 0.01
```

### 语义稳定性计算
```
semantic_stability = 1 / (1 + S²)
```
**其中S为语义漂移系数**：量化token语义向量在时空维度上的稳定性

### 距离阻力计算
```
base_resistance = B2_gain × (abs(distance_change) / B2_threshold)
```

## � 核心概念定义

### 语义漂移系数 S(t)
- **定义**：量化token语义向量在时空维度上的稳定性指标
- **计算方法**：基于全局语义锚点、局部稳定性修正和中文形态修正
- **取值范围**：S ∈ [0, 1]，值越小表示语义越稳定
- **物理意义**：反映token在Transformer各层间的语义漂移程度

### 语义聚合速率（曲率演化速率）
- **定义**：token语义聚合的瞬时变化速度
- **数据来源**：直接观测Transformer各层的实际变化率
- **作用**：作为预测的基础趋势信号
## 🔧 数值稳定性控制

- **语义漂移裁剪**：`np.clip(current_S, 0, 0.001)`
- **调节因子裁剪**：`np.clip(regulation_factor, 0.5, 1.5)`
## 📈 预测流程

1. **输入**：前层实际观测值 (K, D, S, 曲率演化速率)
2. **计算回路效果**：R1增强 + B1稳定性抑制 + B2距离阻力
3. **生成调节因子**：综合各回路贡献
4. **预测下一层**：K(L) = K(L-1) + 曲率演化速率(L) × regulation_factor

## 🎯 模型优势

- ✅ **物理可解释性**：基于经典系统动力学理论
- ✅ **数值稳定性**：多重裁剪防止发散
- ✅ **参数可调**：回路增益可根据数据调整
- ✅ **趋势捕获**：成功预测语义演化的主要方向

## 📊 性能指标

- **MAE**：平均绝对误差 (衡量预测精度)
- **MAPE**：平均绝对百分比误差 (衡量相对误差)
- **稳定性**：参数收敛且预测不发散